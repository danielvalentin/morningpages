<?php defined('SYSPATH') or die('No direct script access.');class Model_Dashboard extends ORM {		protected $_has_many = array(		'widgets' => array(),	);		protected $_belongs_to = array(		'user' => array()	);		public function info()	{		$mywidgets = array();		$widgets = $this->widgets->find_all();		if((bool)$widgets->count())		{			foreach($widgets as $widget)			{				$mywidgets[] = $widget->info();			}		}				return array(			'id' => $this->id,			'user_id ' => $this->user_id,			'order' => $this->order,			'name' => $this->name,			'current' => $this->current,			'widgets' => $mywidgets		);	}		public function setcurrent()	{		$current = ORM::factory('dashboard')->where('current','=',1)->find();		if($current->loaded())		{			$current->current = 0;			$current->save();		}		$this->current = 1;		$this->save();	}		public function delete()	{		$widgets = $this->widgets->find_all();		if((bool)$widgets->count())		{			foreach($widgets as $widget)			{				$widget->delete();			}		}		return parent::delete();	}		public function getcurrent()	{		$current = ORM::factory('dashboard')			->where('current','=',1)			->where('user_id','=',user::get()->id)			->find();		if(!$current->loaded())		{			$current = ORM::factory('dashboard')				->where('user_id','=',user::get()->id)				->find();			if(!$current->loaded())			{				$current->user_id = user::get()->id;				$current->current = 1;				$current->name = 'Kontrolpanel';				$current->order = 0;				$current->save();			}		}		return $current;	}	}