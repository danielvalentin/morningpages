<?php defined('SYSPATH') or die('No direct script access.');class Model_Visitor extends ORM {		public function history()	{		return json_decode($this->history);	}		public function page()	{		$page = $this->page;		if(empty($page))		{			$page = '<em>Forsiden</em>';		}		return $page;	}		public function info()	{		$username = 'Anonymous';		if($this->user_id != 0)		{			$user = ORM::factory('User',$this->user_id);			if($user->loaded())			{				$username = HTML::anchor('cms/#/users/edit/'.$user->id, $user->username);			}		}		return array(			'username' => $username,			'client' => $this->client,			'ip' => $this->ip,			'referrer' => ($this->referrer == ''?'Unknown':$this->referrer),			'time' => time()-$this->start		);	}		public function start()	{		$start = $this->start;		$diff = time()-$start;		$hours = floor($diff / 60 / 60); 		if($hours > 0)		{			$minsleft = $diff - ($hours*60*60);			$mins = floor($minsleft / 60);		}		else		{			$mins = floor($diff / 60);		}		if($mins > 0)		{			$secs = $diff - ($mins * 60);		}		else		{			$secs = $diff;		}		$hours = str_pad($hours, 2,'0', STR_PAD_LEFT);		$mins = str_pad($mins, 2,'0', STR_PAD_LEFT);		$secs = str_pad($secs, 2,'0', STR_PAD_LEFT);		return $hours.':'.$mins.':'.$secs;	}	}